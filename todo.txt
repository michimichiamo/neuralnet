- save data in global array in order to avoid dereferencing problems

Something like

double* x[K] = (double*)malloc(K*N*sizeof(double));
//same for W
double N[K];
//same for b

Where each of the K pointers contains N (for x, N-R+1 for W) elements (although the k-th pointer only needs N-K(R+1) elements - but we can't have different sizes).

- pass both structs and array data to allocate()